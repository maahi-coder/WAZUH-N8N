<ossec_config>

  <!-- GLOBAL -->
  <global>
    <jsonout_output>yes</jsonout_output>
    <alerts_log>yes</alerts_log>
  </global>

  <!-- ALERT LEVEL (LOCAL LOGGING ONLY) -->
  <alerts>
    <log_alert_level>3</log_alert_level>
  </alerts>

  <!-- REMOTE (MANDATORY) -->
  <remote>
    <connection>secure</connection>
    <port>1514</port>
    <protocol>tcp</protocol>
  </remote>

  <!-- LINUX LOGS -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/auth.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/syslog</location>
  </localfile>

  <!-- ðŸ”¥ CUSTOM N8N INTEGRATION (HIGH SIGNAL ONLY) -->
  <integration>
    <name>custom-n8n</name>

    <!-- ONLY IMPORTANT ATTACK RULES -->
    <rule_id>
      ^5710$|        <!-- SSH brute force -->
      ^5716$|        <!-- SSH auth failed -->
      ^60122$|       <!-- Suspicious PowerShell -->
      ^18107$|       <!-- Malware / suspicious file -->
      ^18108$|       <!-- Malicious file download -->
      ^18109$        <!-- Phishing / suspicious URL -->
    </rule_id>

    <alert_format>json</alert_format>
  </integration>

</ossec_config>
